#!nsh
#
# @name 3DR Iris Quadrotor SITL (Depth)
#
# @type Quadrotor Wide
#

sh /etc/init.d-posix/10016_iris

if [ $AUTOCNF = yes ]
then
	# EKF2: Vision position and heading + Optical Flow
	param set EKF2_AID_MASK 26
	param set EKF2_EV_DELAY 150

	# EKF2: height mode set to range sensor
	param set EKF2_HGT_MODE 2

	# Control height relative to ground
	param set MPC_ALT_MODE 2

	# LPE: Vision + OF + baro
	param set LPE_FUSION 134

	# AEQ: External heading set to use vision input
	param set ATT_EXT_HDG_M 1

	# A set of parameters to make the vehicle more stable
	# while flying with SLAM
	param set MIS_TAKEOFF_ALT 1.5
	param set MC_YAWRATE_MAX 25
	param set MC_YAWRATE_P 0.16
	param set MC_YAW_P 2.4
	param set MPC_ACC_HOR 5
	param set MPC_CRUISE_90 2
	param set MPC_HOLD_MAX_XY 1
	param set MPC_HOLD_MAX_Z 2
	param set MPC_MAN_TILT_MAX 10
	param set MPC_TILTMAX_AIR 10
	param set MPC_TILTMAX_LND 10
	param set MPC_VEL_MANUAL 2
	param set MPC_XY_CRUISE	1
	param set MPC_XY_P 0.8
	param set MPC_XY_VEL_MAX 2
	param set MPC_XY_VEL_P 0.2
	param set MPC_Z_VEL_MAX_UP 2
	param set NAV_ACC_RAD 2
fi
